<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="" />
    <meta name="”keywords”" content="" />
    <title>모두의탱고 pivot</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <link href="css/main.css" rel="stylesheet" />
    <meta property="og:title" content="모두의탱고" />
    <meta property="og:description" content="20대 탱고" />
    <meta property="og:image" content="" />
    <meta name="theme-color" content="#ffffff" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

  </head>

  <body id="lbody">
    <main>
      <button class = "startbtn" 
      type = "button"
      onclick="pomoStart(); this.onclick='';">시작</button>
      
      <div class="">
        <div class="timer">
        </div>
        <div class="window-box">
        </div>
        <div class="top-info-box">
          <div class="title-box">
            <img src="images/modotango-logo-v12.png" class="f-logo">
            <h2>기본기</h2>
            <div class="swiper curriSwiper">
              <div class="swiper-wrapper">
                <div class="swiper-slide">
                  <div class="curri-cell" id="t1"><h2>피벗</h2></div>
                </div>
                <!-- <div class="swiper-slide">
                  <div class="curri-cell" id="t2"><h2>피봇</h2></div> 
                </div>
                <div class="swiper-slide">
                  <div class="curri-cell" id="t3"><h2>크로스 스텝</h2></div>
                </div>
                <div class="swiper-slide">
                  <div class="curri-cell" id="t4"><h2>크로스 변형</h2></div>
                </div>
                <div class="swiper-slide">
                  <div class="curri-cell" id="t5"><h2>백 오초</h2></div>
                </div>
                <div class="swiper-slide">
                  <div class="curri-cell" id="t6"><h2>프런트 오초</h2></div>
                </div> -->
              </div>
            </div>
          </div>
        </div>
        <div class="slide-box">
          <div class="video-wrapper">
            <div class="videoscroll">
              <div class="swiper mySwiper">
                <div class="swiper-wrapper">
                  <div class="swiper-slide">
                    <div class="embed-responsive embed-responsive-16by9 ytvideobox">
                      <div id="player1"></div>
                    </div>
                  </div>
                  <!-- <div class="swiper-slide">
                    <div class="embed-responsive embed-responsive-16by9 ytvideobox">
                      <div id="player2"></div>
                    </div>
                  </div>
                  <div class="swiper-slide">
                    <div class="embed-responsive embed-responsive-16by9 ytvideobox">
                      <div id="player3"></div>
                    </div>
                  </div>
                  <div class="swiper-slide">
                    <div class="embed-responsive embed-responsive-16by9 ytvideobox">
                      <div id="player4"></div>
                    </div>
                  </div>
                  <div class="swiper-slide">
                    <div class="embed-responsive embed-responsive-16by9 ytvideobox">
                      <div id="player5"></div>
                    </div>
                  </div>
                  <div class="swiper-slide">
                    <div class="embed-responsive embed-responsive-16by9 ytvideobox">
                      <div id="player6"></div>
                    </div>
                  </div> -->
                </div>
                <div class="swiper-pagination"></div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </main>
    <script>
      let windowBox = document.querySelector('.window-box');
      let infoBox = document.querySelector('.top-info-box');
      let slideBox = document.querySelector('.slide-box');
      let checkBox = document.querySelector('.check-box');
      
      let windowBoxHeight = windowBox.offsetHeight;

      let infoBoxHeight = infoBox.offsetHeight;
      let slideBoxHeight = slideBox.offsetHeight;
      var windowInnerHeight = screen.height;
      var remainTopBoxHeight = windowBoxHeight - infoBoxHeight;
      var youtubeWidht = remainTopBoxHeight * (16/9);

      

     
      setTimeout(function(){
        setInterval(swiper.slideTo(0), 1000);
      }, 1000);

      
      
    </script>
    <script>
      var tag = document.createElement('script');
      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      // 3. This function creates an <iframe> (and YouTube player)
      //    after the API code downloads.
      var player1, player2, player3, player4, player5, player6;
      var player1VideoId, player2VideoId, player3VideoId, player4VideoId, player5VideoId, player6VideoId;
  

      function onYouTubeIframeAPIReady() {
        player1VideoId = 'GlPHc_jfE_4';
        // player2VideoId = 'JnAKkkRekOU';
        // player3VideoId = 'SY57c2aftu8';
        // player4VideoId = 'weRpILBuFCY';
        // player5VideoId = 'ICeRDkUUh2A';
        // player6VideoId = 'TKSrU0uqxCM';
  
  
        player1 = new YT.Player('player1', {
          width: youtubeWidht,
          height: remainTopBoxHeight,
          videoId: player1VideoId,
          playerVars: {
            // autoplay: true, // 자동 재생 유무
            loop: true,     // 반복 재생 유무
            // playlist: 'EJF919p_hb0',
            // start: 0,
            // end: 35
          },
          events: {
            'onReady': function(event){
              event.target.mute();  // 음소거
              // event.target.playVideo();   // 반대 역할 : stopVideo();
            },
            'onStateChange': onPlayerStateChange
          }
          // events: {
          //   'onStateChange': onPlayerReady
          // }
        });
        
        function onPlayerStateChange(event) {
          if (event.data == YT.PlayerState.ENDED) {
            event.target.playVideo();
          }
        }
  
      }
      

      function reportWindowSize() {

      
      windowBox = document.querySelector('.window-box');
      infoBox = document.querySelector('.top-info-box');
      slideBox = document.querySelector('.slide-box');
      checkBox = document.querySelector('.check-box');

      windowBoxHeight = windowBox.offsetHeight;

      infoBoxHeight = infoBox.offsetHeight;
      slideBoxHeight = slideBox.offsetHeight;
      windowInnerHeight = screen.height;
      remainTopBoxHeight = windowBoxHeight - infoBoxHeight;
      youtubeWidht = remainTopBoxHeight * (16/9);

      // console.log("resize");
      t1 = document.querySelector('#t1');
      player1 = document.querySelector('#player1');
      // t1.innerHTML = youtubeWidht;
      player1.width = youtubeWidht;
      player1.height = remainTopBoxHeight;
      }

      window.onresize = reportWindowSize;
  
    </script>
     <!-- Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <!-- Initialize Swiper -->
    <script>

      var swiperCurri = new Swiper(".curriSwiper", {
        slidesPerView: "auto",
        centeredSlides: true,
      });
      var swiper = new Swiper(".mySwiper", {
        slidesPerView: "auto",
        centeredSlides: true,
        // direction: "vertical",
        height: remainTopBoxHeight,
        pagination: {
          el: ".swiper-pagination",
          clickable: true,
        },
      });
      setTimeout(function(){
        setInterval(swiper.slideTo(0), 1000);
      }, 1000);

    </script>
    <script>
      const pomoBtn = document.querySelector(".btn");
      const timer = document.querySelector(".timer");
      var allTrainingCell = document.querySelectorAll(".technic-cell");
      var mainvideo = document.querySelector("#mainv");
      var nowTraninCell =  document.querySelector("#t1");
      var nextProgramCell =  document.querySelector("#t2");

      let categoryText;
      let pomoInterval;
      let restInterval;
      // let pomoTime = 1500;
      let pomoTime = 10;
      let restTime = 5;
      // let restTime = 300;

      // var trainings = [["traning", 3, "#t1"], ["rest", 3, "#t2"], ["traning", 3, "#t2"], ["rest", 3, "#t3"], ["traning", 3, "#t3"], ["rest", 3, "#t4"], ["traning", 3, "#t4"], ["rest", 5, "#t5"], ["traning", 7, "#t5"], ["rest", 5, "#t6"], ["traning", 7, "#t6"]];
      var trainings = [["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"], ["traning", 600, "#t1"], ["rest", 180, "#t1"]];

      var nowTraingTime = trainings[0][1];
      var totalStep = trainings.length;
      var nowStep = 0;
      var nowStatus = "traning";
      var nowProgram = "#t1";
      var nextProgram = "#t1";


      function pomoStart() {
        nowTraninCell = document.querySelector(nowProgram);
        nowTraninCell.classList.add("now")
        timer.classList.add(trainings[0][0]);
        timer.innerHTML = "Go!";
        player1.playVideo();

        setTimeout(function(){
          pomodoro();
          pomoInterval = setInterval(pomodoro, 1000);
        }, 1000);

      }
      
      function pomodoro() {
        // const minutes = String(Math.floor(pomoTime / 60)).padStart(2, "0");
        // const seconds = String(pomoTime % 60).padStart(2, "0");
        // nowTraingTime = trainings[0][1];
        const minutes = String(Math.floor(nowTraingTime / 60)).padStart(2, "0");
        const seconds = String(nowTraingTime % 60).padStart(2, "0");


        // pomoTime -= 1;
        nowTraingTime -= 1;

        timer.innerHTML = `${minutes} : ${seconds}`;

        if (nowTraingTime < 0) {
                            clearInterval(pomoInterval);
                            nowStep += 1;
                            console.log(totalStep, "&&",nowStep);
                            if(totalStep > nowStep) {
                              nowTraingTime = trainings[nowStep][1];
                              nowStatus = trainings[nowStep][0];
                              nowProgram = trainings[nowStep][2];
                            } else {
                              // return;
                              nowStep = 1;
                              nowTraingTime = trainings[nowStep][1];
                              nowStatus = trainings[nowStep][0];
                              nowProgram = trainings[nowStep][2];
                            }
                           
                            if(totalStep > nowStep+1) {
                              nextProgram = trainings[nowStep+1][2];
                            }

                            timer.classList.remove("traning");
                            timer.classList.remove("rest");
                            timer.classList.add(nowStatus);
                            
                            for ( var i = 0; i < allTrainingCell.length; i++ ) {
                              allTrainingCell[i].classList.remove("now");
                            }
                            if (nowStatus != "rest") {
                              nowTraninCell = document.querySelector(nowProgram);
                              nowTraninCell.classList.add("now");
                              for ( var i = 0; i < allTrainingCell.length; i++ ) {
                                allTrainingCell[i].classList.remove("next");
                              }
                            } else {
                              nowTraninCell = null;
                              if (totalStep == nowStep) {
                                nextProgramCell = document.querySelector(nextProgram);
                                nextProgramCell.classList.add("next");
                              } else {
                                nextProgramCell = document.querySelector(nextProgram);
                                nextProgramCell.classList.add("next");
                              }
                            }
                            console.log("end", totalStep == nowStep);

                            if (totalStep == nowStep) {
                              console.log("끝");
                              
                              restStart("traning", "#t1");
                            } else {
                              restStart(nowStatus, nowProgram);
                            }
                            
                            
                            // beep();
        }
      }
      
      function restStart(nowStatus, nowProgram) {
        console.log(nowProgram);
        
        if (nowStatus == "traning") {
          timer.innerHTML = "Go!";

        } else {
          timer.innerHTML = "휴식";
          swiper.slideNext();
          swiperCurri.slideNext();
          if(nowProgram == "#t1") {
            player1.playVideo();
          } else if (nowProgram == "#t2") {
            player1.stopVideo();
            player2.playVideo();

          } else if (nowProgram == "#t3") {
            player2.stopVideo();
            player3.playVideo();

          } else if (nowProgram == "#t4") {
            player3.stopVideo();
            player4.playVideo();

          } else if (nowProgram == "#t5") {
            player4.stopVideo();
            player5.playVideo();

          } else if (nowProgram == "#t6") {
            player5.stopVideo();
            player6.playVideo();

          }          

        }
        setTimeout(function(){
          pomoInterval = setInterval(pomodoro, 1000);
        }, 1000);

      }
      


    </script>

  
  </body>
</html>
